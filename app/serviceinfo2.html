<!DOCTYPE html>
<html>
<head>
	<title>{_name} 预约猫 商品详情</title>
	<meta charset="utf-8">
	<link rel="shortcut icon" href="images/favicon.ico" />
    <meta name="keywords" content="预约猫,  {_name}"/>
    <meta name="description" content=" 预约猫让您不再排队，享受VIP般的尊贵服务，不用现场排队，不用现场买单
预约猫让商家的资源使用高效而有秩序，通过预约，让时间变得可管理、有序的客流让你不会太闲也不会太忙。"/>
	<link rel="stylesheet" href="skin/css/reset.css">
	<link rel="stylesheet" href="skin/css/screen.css">
	<link rel="stylesheet" href="skin/css/swiper.min.css">
	<link rel="stylesheet" href="https://at.alicdn.com/t/font_234130_nem7eskcrkpdgqfr.css">
	<script src="skin/js/jquery-2.1.1.min.js"></script>
	
	<script src="skin/js/swiper.min.js"></script>
	<script src="skin/js/screen.js"></script>

	
	<script type="text/javascript">
		var pixclPatio = 1 / window.devicePixelRatio;
		document.write('<meta name="viewport" content="width=device-width,initial-scale='+pixclPatio+',minimum-scale='+pixclPatio+',maximum-scale='+pixclPatio+',user-scalable=no" />');
	</script>
	 <script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?83fc41ced71de2d6a049a7b2bc8ea112";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
</head>
<body>
	<div class="sjproject">
		<div class="p-header">
			<span>项目详情</span>
			<a href="javascript:history.back()" class="header-back"></a>
			<a href="#" class="share"></a>
			<a href="#" class="collect"></a>
		</div>
		<div class="main content">
			<!--<img src="skin/images/projectbj.png" alt="" class="projectbj"> -->
					<div class="swiper-container sj-swiper">
						<div class="swiper-wrapper">
							 {_FOREACH pic}
     
      <div class="swiper-slide"><img src="../{_picname}" alt="项目详情" class="projectbj"></div>
      {ENDFOR}
							
							
						</div>	
					</div><!--swiper-container-->
			
			<div class="txt">
				<h3 class="name">{_name}</h3>
				<div class="price">
					<div class="left leisure">闲时价:<span>￥{_xian.price}</span></div>
					<div class="left market">门市价：￥{_price}</div>
				</div>
				<div class="time">
					<div class="left market dotime">营业时间：{_begin1}-{_end1} {_IF begin2} {_begin2}-{_end2} {ENDIF}</div>
					<!--div class="left market">休息时间：8:00~20:00</div-->
				</div>
				<div class="calculation">
					<span class="subtraction">-</span>
					<span class="num">1</span>
					<span class="add">+</span>
				</div>
			</div><!--txt-->
			<div class="description">
				<div class="top">
					<img src="../{_pic.0.picname}" alt="" class="img10">
					<div class="details">
						<!--div class="name">首席理发师</div-->
						<div class="dd">
							<strong>下单后可以在订单上看到商家电话并与商家联系确认</strong>
     <br>
     闲时价时间段：周{_xian.stopweekday} {_xian.begin1}-{_xian.end1}
     <br>
     最小预订时间单位：{_unit}分钟
     <br>
     周休息日：{_stopweekday}
      <!--<img src="images/image4.jpg" width="636" height="822" />-->
<br>
公司名：<big><a href="index.php?act=shop&id={_userid}"> <font color="#0000FF"> {_userinfo.name} </font></a></big>
<br>
地址：{_userinfo.address}
<br>
服务内容：{_userinfo.into}
<br>
      <a href="index.php?act=code2&url={_url}&title={_name}"><font color="#FF0000"> 下载二维码</font></a>
      <br>
      {_remark}
							
						</div>
						<!--div class="popularity">
							<span>人气</span>
							<img src="skin/images/star.png" alt="" class="star">
							<img src="skin/images/star.png" alt="" class="star">
							<img src="skin/images/star.png" alt="" class="star">
							<img src="skin/images/star.png" alt="" class="star">
							<img src="skin/images/star.png" alt="" class="star">
						</div-->
						
					</div>
				</div><!--top-->
         <form id="fm1" action="index.php?act=confirm" method="post">
				<div class="bespeak">
					<div class="left">
						<span>预定日期:</span>
            <input type="date" class="form-control pull-right" id="datepicker" placeholder="选择预订日期" name='dt' > 
						<!--span class="h3Ele">请选择日期</span-->
					</div>
					<div class="time left sjd-box">
						<span>时间段:</span>
						<span class="sjd"> </span>
					</div>
					  <input type="hidden" id="timerange" name="timerange">
             <input type="hidden" id="num" name="num" value="1">
             <input type="hidden" name="serviceid" id="serviceid" value="{_id}" >
				</div>
      </form>
			</div>
			

		</div>
		
		
		<div class="bottom">
			<dl>
				<dt><img src="skin/images/icon21.png" alt="" class="icon21"> </dt>
				<dd>客服</dd>
			</dl>
			<dl>
				<dt><img src="skin/images/icon23.png" alt="" class="icon23"> </dt>
				<dd>我是会员</dd>
			</dl>
			<div class="active" id="sub">预约</div>
		</div>
		
		
	</div>
	<div id='schedule-box' class="boxshaw">
		
	</div>
	<div class="content time-slot">
			<div class="time-appointment">预约时间</div>
			<span>09:00-10:00</span>
			<span>10:00-11:00</span>
			<span>11:00-12:00</span>
			<span>12:00-13:00</span>
			<span>13:00-14:00</span>
			<span>14:00-15:00</span>
			<span>15:00-16:00</span>
			<span>16:00-17:00</span>
			<div class="end"></div>
			
		</div>
	
 <script src="skin/js/schedule.js"></script>
  <script src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
  /*
   * 注意：
   * 1. 所有的JS接口只能在公众号绑定的域名下调用，公众号开发者需要先登录微信公众平台进入“公众号设置”的“功能设置”里填写“JS接口安全域名”。
   * 2. 如果发现在 Android 不能分享自定义内容，请到官网下载最新的包覆盖安装，Android 自定义分享接口需升级至 6.0.2.58 版本及以上。
   * 3. 常见问题及完整 JS-SDK 文档地址：http://mp.weixin.qq.com/wiki/7/aaa137b55fb2e0456bf8dd9148dd613f.html
   *
   * 开发中遇到问题详见文档“附录5-常见错误及解决办法”解决，如仍未能解决可通过以下渠道反馈：
   * 邮箱地址：weixin-open@qq.com
   * 邮件主题：【微信JS-SDK反馈】具体问题
   * 邮件内容说明：用简明的语言描述问题所在，并交代清楚遇到该问题的场景，可附上截屏图片，微信团队会尽快处理你的反馈。
   */
  wx.config({
     debug: false,
    appId: '{_signPackage.appId}',//'<?php echo $signPackage["appId"];?>',
    timestamp: '{_signPackage.timestamp}',//'<?php echo $signPackage["timestamp"];?>,
    nonceStr: '{_signPackage.nonceStr}',//''<?php echo $signPackage["nonceStr"];?>',
    signature: '{_signPackage.signature}',//''<?php echo $signPackage["signature"];?>',
    jsApiList: ['onMenuShareTimeline','onMenuShareAppMessage','onMenuShareQQ','onMenuShareWeibo','onMenuShareQZone'
      // 所有要调用的 API 都要加到这个列表中
    ]
  });
  wx.ready(function () {
    // 在这里调用 API
        wx.onMenuShareTimeline({
        title: '{_name}-预约猫', // 分享标题
        link: 'https://yuyuemao.cn/app/index.php?act=serviceinfo&id={_id}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
        imgUrl: 'https://yuyuemao.cn/{_pic.0.picname}', // 分享图标
        success: function () {
        // 用户确认分享后执行的回调函数
        },
        cancel: function () {
            // 用户取消分享后执行的回调函数
            }
        });

        wx.onMenuShareAppMessage({
        title: '{_name}-预约猫', // 分享标题
        desc: '', // 分享描述
        link: 'https://yuyuemao.cn/app/index.php?act=serviceinfo&id={_id}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
        imgUrl: 'https://yuyuemao.cn/{_pic.0.picname}', // 分享图标
        type: '', // 分享类型,music、video或link，不填默认为link
        dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空
        success: function () {
        // 用户确认分享后执行的回调函数
        },
        cancel: function () {
        // 用户取消分享后执行的回调函数
        }
        });

         wx.onMenuShareQQ({
        title: '{_name}-预约猫', // 分享标题
        link: 'https://yuyuemao.cn/app/index.php?act=serviceinfo&id={_id}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
        imgUrl: 'https://yuyuemao.cn/{_pic.0.picname}', // 分享图标
        success: function () {
        // 用户确认分享后执行的回调函数
        },
        cancel: function () {
            // 用户取消分享后执行的回调函数
            }
        });

        wx.onMenuShareWeibo({
        title: '{_name}-预约猫', // 分享标题
        link: 'https://yuyuemao.cn/app/index.php?act=serviceinfo&id={_id}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
        imgUrl: 'https://yuyuemao.cn/{_pic.0.picname}', // 分享图标
        success: function () {
        // 用户确认分享后执行的回调函数
        },
        cancel: function () {
            // 用户取消分享后执行的回调函数
            }
        });

        wx.onMenuShareQZone({
        title: '{_name}-预约猫', // 分享标题
        link: 'https://yuyuemao.cn/app/index.php?act=serviceinfo&id={_id}', // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致
        imgUrl: 'https://yuyuemao.cn/{_pic.0.picname}', // 分享图标
        success: function () {
        // 用户确认分享后执行的回调函数
        },
        cancel: function () {
            // 用户取消分享后执行的回调函数
            }
        });

  });






  $(function () {
   
    //Date picker
    /*$('#datepicker').datepicker({
      language: "zh-CN",
      autoclose: true,
      format: "yyyy-mm-dd",
      defaultDate : new Date() ,
      startDate:new Date()  
    });



    $("#datepicker").focus(function(){
        document.activeElement.blur();
    });

    //Timepicker
    $(".timepicker").timepicker({
      showInputs: true
    });

*/

    var pkvalue="";
    $("#datepicker").change(function(){


    $(".time-slot").show();
    var $this=$(this);
    $(".time-slot span").unbind("click");
    $(".time-slot span").click(function(e){
    
      $this.find(".sjd").text($(this).text());
      $(".time-slot").hide();
    })
 
    if(this.value!=pkvalue)
    {
     // alert(this.value);
      pkvalue=this.value;
      
     $.get(
        'index.php?act=ajaxTimeList', 
        {
          dt: this.value,
          id:{_id},
        }, 
        function(data, textStatus, xhr) 
        {
          var tmp=" <div class=\"time-appointment\">预约时间</div>";
          data=$.parseJSON(data);
          for(x in data)
          {
            if(data[x][1]=="0")
            {
              if(data[x][3]>"0")
                tmp+='<span><a href="javascript:;">'+data[x][0]+' <font color=red>¥'+data[x][3]+'</font></a></span>';
              else
                tmp+='<span><a href="javascript:;">'+data[x][0]+'</a></span>';
            }
            else if(data[x][3]>"0")
            tmp+='<span><a href="javascript:;">'+data[x][0]+'-'+data[x][1]+' <font color=red>¥'+data[x][3]+'</font></a></span>';
            else
              tmp+='<span><a href="javascript:;">'+data[x][0]+'-'+data[x][1]+'</a></span>';

          }

          if(data.length<1)
            tmp+='<span><a href="javascript:;">该天不能预约</a></span>';

          tmp+='<span>完成</span> <div class="end"></div>';
          
         
     
          $(".time-slot").html(tmp);
          
        });
    }
    

    });

    $(".time-slot").on('click',' span',function(event) {
      /* Act on the event */
    //console.log(event);
      // cura=$(this).find('a');

      cura=$(this);

      if(cura.text()=="完成")
        {
          $(".time-slot").hide();
           tmp="";

      $(".active2").each(function(index, el) {
        tmp+=" "+$(this).text();
      });
      num=$(".num").text();
      if(num>0)
        $("#num").val(num);
//alert(tmp);
      $("#timerange").val(tmp);
      $(".sjd").html(tmp);

          return;
        }
      if(cura.attr('class')!="active2")
      {
        //this.className="active2";
        cura.attr("class","active2");
      }
      else
      {
        //this.className="";
        cura.attr("class","");
      }
    });

    $("#sub").click(function(event) {
      /*传id和时间段给后台  */
      tmp="";

      $(".active2").each(function(index, el) {
        tmp+=" "+$(this).text();
      });
      num=$(".num").text();
      if(num>0)
        $("#num").val(num);
//alert(tmp);
      $("#timerange").val(tmp);
      if(tmp.length<1)
      {
        alert("轻选择正确的时间预约");
        return;
      }



      $("#fm1").submit();
        /* Act on the event */
      //});

    });

  });

	

		
			var mySchedule = new Schedule({
				el: '#schedule-box',
				//date: '2018-9-20',
				clickCb: function (y,m,d) {
					
					document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	  
					
				},
				nextMonthCb: function (y,m,d) {
					 document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d 	
		
				},
				nextYeayCb: function (y,m,d) {
					 document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d 
	
				},
				prevMonthCb: function (y,m,d) {
					 document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d 

				},
				prevYearCb: function (y,m,d) {
					 document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	 

				}
			});
				
	
		
			
		$(".sjd-box").click(function()
      {
        $(".time-slot").show();
      });
		 
	 
		
		
	
	
/* 	var mySchedule = new Schedule({
		el: '#schedule-box',
		//date: '2018-9-20',
		clickCb: function (y,m,d) {
			
			document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	
		},
		nextMonthCb: function (y,m,d) {
			document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	
		},
		nextYeayCb: function (y,m,d) {
			document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	
		},
		prevMonthCb: function (y,m,d) {
			document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	
		},
		prevYearCb: function (y,m,d) {
			document.querySelector('.h3Ele').innerHTML = y+'-'+m+'-'+d	
		}
	}); */
</script>

</body>
</html>